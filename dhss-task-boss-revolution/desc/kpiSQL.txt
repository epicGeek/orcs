
select total_view.hlrsn,total_view.operation_name,total_view.period_start_time,ifnull(fail_count,0) as fail_count,total_count from 
(select count(1) as total_count,
hlrsn,operation_name,
DATE_ADD(date_format(re_time,"%Y-%m-%d %H:00"),interval (minute(re_time) div 15) *15 minute) as period_start_time
from boss_soap 
group by hlrsn,operation_name,
period_start_time) total_view
left join 
(select count(1) as fail_count,
hlrsn,operation_name,
DATE_ADD(date_format(re_time,"%Y-%m-%d %H:00"),interval (minute(re_time) div 15) *15 minute) as period_start_time
from boss_err_case 
group by hlrsn,operation_name,
period_start_time) fail_view 
-- using (hlrsn,operation_name,period_start_time)
on 
fail_view.hlrsn = total_view.hlrsn 
and 
fail_view.operation_name = total_view.operation_name 
and 
fail_view.period_start_time = total_view.period_start_time 